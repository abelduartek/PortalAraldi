import{a as W,b as K}from"./chunk-4EGVALWB.js";import{c as D,f as F}from"./chunk-UJ6JPARJ.js";import{a as $}from"./chunk-PZY37AG5.js";import"./chunk-5CFUHLDA.js";import{a as L,b as J}from"./chunk-4YQRIOBB.js";import{d as A,e as H,k as U}from"./chunk-BKUSUYWF.js";import"./chunk-CGJ4C2IJ.js";import{a as V,b as j}from"./chunk-7F2FX24T.js";import{H as B,J as R,y as z}from"./chunk-ZOL5ZLUF.js";import"./chunk-KRKX4DJQ.js";import{Ab as y,Bb as i,Cb as c,Db as M,Eb as w,Gb as P,Ha as o,Hb as N,Ib as I,Kb as h,Ma as S,Sa as E,Xa as u,Z as f,_,gb as p,hb as t,ib as e,jb as g,mc as O,nb as v,nc as T,ob as x,pb as s,qc as k,zb as C}from"./chunk-QFKUKTN6.js";var q=()=>({width:"600px"}),Q=()=>({"font-size":"0.75rem"});function G(r,m){if(r&1){let n=v();t(0,"div",11)(1,"h3"),i(2,"CNPJs Monitorados"),e(),t(3,"button",12),x("click",function(){f(n);let l=s();return _(l.importarNotas())}),e()()}}function X(r,m){r&1&&(t(0,"tr")(1,"th"),i(2,"CNPJ"),e(),t(3,"th"),i(4,"Nome Fantasia"),e(),t(5,"th"),i(6,"\xDAltima Importa\xE7\xE3o"),e(),t(7,"th"),i(8,"Status"),e(),t(9,"th"),i(10,"A\xE7\xF5es"),e()())}function Y(r,m){if(r&1){let n=v();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),g(8,"p-tag",13),e(),t(9,"td")(10,"div",14)(11,"button",15),x("click",function(){let l=f(n).$implicit,d=s();return _(d.configurarCNPJ(l))}),e(),t(12,"button",16),x("click",function(){let l=f(n).$implicit,d=s();return _(d.verHistorico(l))}),e()()()()}if(r&2){let n=m.$implicit,a=s();o(2),c(n.cnpj),o(2),c(n.nomeFantasia),o(2),c(a.formatDate(n.ultimaImportacao)),o(2),p("severity",a.getStatusSeverity(n.status))("value",n.status)}}function Z(r,m){r&1&&(t(0,"h3"),i(1,"Hist\xF3rico de Notas Fiscais"),e())}function tt(r,m){r&1&&(t(0,"tr"),g(1,"th",17),t(2,"th"),i(3,"N\xFAmero"),e(),t(4,"th"),i(5,"Fornecedor"),e(),t(6,"th"),i(7,"Data"),e(),t(8,"th"),i(9,"Valor Total"),e(),t(10,"th"),i(11,"Status"),e(),t(12,"th"),i(13,"Pagamento"),e(),t(14,"th"),i(15,"A\xE7\xF5es"),e()())}function et(r,m){if(r&1){let n=v();t(0,"tr")(1,"td"),g(2,"button",18),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),i(8),e(),t(9,"td"),i(10),e(),t(11,"td"),g(12,"p-tag",13),e(),t(13,"td"),g(14,"p-tag",13),e(),t(15,"td")(16,"div",14)(17,"button",19),x("click",function(){let l=f(n).$implicit,d=s();return _(d.verNota(l))}),e()()()()}if(r&2){let n=m.$implicit,a=m.expanded,l=s();o(2),p("pRowToggler",n)("icon",a?"pi pi-chevron-down":"pi pi-chevron-right"),o(2),c(n.numero),o(2),c(n.fornecedor),o(2),c(l.formatDate(n.data)),o(2),c(l.formatCurrency(n.valorTotal)),o(2),p("severity",l.getNotaStatusSeverity(n.status))("value",l.getNotaStatusLabel(n.status)),o(2),p("severity",n.pagamentoIdentificado?"success":"danger")("value",n.pagamentoIdentificado?"Sim":"N\xE3o")}}function nt(r,m){if(r&1&&(t(0,"span",39),i(1),e()),r&2){let n=s().$implicit;o(),c(n.tipoDespesa)}}function it(r,m){if(r&1&&(t(0,"tr")(1,"td")(2,"div",34)(3,"strong"),i(4),e(),u(5,nt,2,1,"span",35),e()(),t(6,"td",36),i(7),e(),t(8,"td",36),i(9),e(),t(10,"td",37),i(11),e(),t(12,"td",37)(13,"strong"),i(14),e()(),t(15,"td",36)(16,"code",38),i(17),e()(),t(18,"td",36),g(19,"p-tag",13),e()()),r&2){let n=m.$implicit,a=m.index,l=s(2);y(a%2===0?"even-row":"odd-row"),o(4),c(n.descricao),o(),p("ngIf",n.tipoDespesa),o(2),c(n.quantidade),o(2),c(n.unidade),o(2),c(l.formatCurrency(n.valorUnitario)),o(3),c(l.formatCurrency(n.valorTotal)),o(3),c(n.ncm),o(2),C(h(13,Q)),p("severity",n.categorizado?"success":"warning")("value",n.categorizado?"Categorizado":"Pendente")}}function at(r,m){r&1&&g(0,"button",40)}function ot(r,m){if(r&1&&(t(0,"tr")(1,"td",20)(2,"div",21)(3,"div",22)(4,"h4"),g(5,"i",23),i(6),e(),t(7,"span",24),i(8),e()(),t(9,"div",25)(10,"table",26)(11,"thead")(12,"tr")(13,"th"),i(14,"Descri\xE7\xE3o"),e(),t(15,"th"),i(16,"Qtd"),e(),t(17,"th"),i(18,"Unidade"),e(),t(19,"th"),i(20,"Valor Unit."),e(),t(21,"th"),i(22,"Valor Total"),e(),t(23,"th"),i(24,"NCM"),e(),t(25,"th"),i(26,"Status"),e()()(),t(27,"tbody"),u(28,it,20,14,"tr",27),e()()(),t(29,"div",28)(30,"div",29)(31,"span",30),i(32,"Total da Nota:"),e(),t(33,"span",31),i(34),e()(),t(35,"div",32),u(36,at,1,0,"button",33),e()()()()()),r&2){let n=m.$implicit,a=s();o(6),M(" Itens da Nota Fiscal ",n.numero," "),o(2),w("",n.itens.length," ",n.itens.length===1?"item":"itens"),o(20),p("ngForOf",n.itens),o(6),c(a.formatCurrency(n.valorTotal)),o(2),p("ngIf",a.hasItemsPendentes(n))}}function rt(r,m){if(r&1&&(t(0,"div",41)(1,"div",42)(2,"label"),i(3,"N\xFAmero:"),e(),t(4,"span"),i(5),e()(),t(6,"div",42)(7,"label"),i(8,"Fornecedor:"),e(),t(9,"span"),i(10),e()(),t(11,"div",42)(12,"label"),i(13,"CNPJ Fornecedor:"),e(),t(14,"span"),i(15),e()(),t(16,"div",42)(17,"label"),i(18,"Data:"),e(),t(19,"span"),i(20),e()(),t(21,"div",42)(22,"label"),i(23,"Valor Total:"),e(),t(24,"span"),i(25),e()(),t(26,"div",42)(27,"label"),i(28,"Status:"),e(),g(29,"p-tag",13),e()()),r&2){let n=s();o(5),c(n.selectedNota.numero),o(5),c(n.selectedNota.fornecedor),o(5),c(n.selectedNota.cnpjFornecedor),o(5),c(n.formatDate(n.selectedNota.data)),o(5),c(n.formatCurrency(n.selectedNota.valorTotal)),o(4),p("severity",n.getNotaStatusSeverity(n.selectedNota.status))("value",n.getNotaStatusLabel(n.selectedNota.status))}}var Mt=(()=>{let m=class m{constructor(a){this.mockDataService=a,this.cnpjs=[],this.notasFiscais=[],this.selectedNota=null,this.showNotaDialog=!1,this.expandedRows={}}ngOnInit(){this.loadData()}loadData(){this.mockDataService.getCNPJs().subscribe(a=>{this.cnpjs=a.sort((l,d)=>new Date(d.ultimaImportacao).getTime()-new Date(l.ultimaImportacao).getTime())}),this.mockDataService.getNotasFiscais().subscribe(a=>{this.notasFiscais=a})}getStatusSeverity(a){switch(a){case"ativo":return"success";case"inativo":return"danger";default:return"info"}}getNotaStatusSeverity(a){switch(a){case"importada":return"success";case"erro":return"danger";case"pendente_categorizacao":return"warning";default:return"info"}}getNotaStatusLabel(a){switch(a){case"importada":return"Importada";case"erro":return"Com Erro";case"pendente_categorizacao":return"Pendente Categoriza\xE7\xE3o";default:return a}}formatCurrency(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}formatDate(a){return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(a))}verNota(a){this.selectedNota=a,this.showNotaDialog=!0}configurarCNPJ(a){console.log("Configurar CNPJ:",a)}verHistorico(a){console.log("Ver hist\xF3rico:",a)}importarNotas(){console.log("Importar notas")}hasItemsPendentes(a){return a.itens.some(l=>!l.categorizado)}};m.\u0275fac=function(l){return new(l||m)(S($))},m.\u0275cmp=E({type:m,selectors:[["app-importacao-notas"]],decls:21,vars:12,consts:[[1,"importacao-notas"],[1,"page-header"],[1,"cnpjs-section"],["pTemplate","header"],[3,"value","responsive"],["pTemplate","body"],[1,"notas-section"],[3,"value","responsive","dataKey"],["pTemplate","rowexpansion"],["header","Detalhes da Nota Fiscal",3,"visibleChange","visible","modal","closable"],["class","nota-details",4,"ngIf"],[1,"card-header"],["pButton","","label","Importar Notas","icon","pi pi-download",1,"p-button-primary",3,"click"],[3,"severity","value"],[1,"action-buttons"],["pButton","","icon","pi pi-cog","pTooltip","Configura\xE7\xF5es",1,"p-button-text","p-button-sm",3,"click"],["pButton","","icon","pi pi-history","pTooltip","Hist\xF3rico",1,"p-button-text","p-button-sm",3,"click"],[2,"width","3rem"],["pButton","","type","button","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["pButton","","icon","pi pi-eye","pTooltip","Ver Nota",1,"p-button-text","p-button-sm",3,"click"],["colspan","8"],[1,"expanded-content"],[1,"expanded-header"],[1,"pi","pi-list"],[1,"item-count"],[1,"items-table-container"],[1,"items-table"],[3,"class",4,"ngFor","ngForOf"],[1,"expanded-footer"],[1,"total-info"],[1,"total-label"],[1,"total-value"],[1,"actions-info"],["pButton","","label","Categorizar Itens","icon","pi pi-tags","class","p-button-warning p-button-sm","routerLink","/categorizacao",4,"ngIf"],[1,"item-description"],["class","tipo-despesa",4,"ngIf"],[1,"text-center"],[1,"text-right"],[1,"ncm-code"],[1,"tipo-despesa"],["pButton","","label","Categorizar Itens","icon","pi pi-tags","routerLink","/categorizacao",1,"p-button-warning","p-button-sm"],[1,"nota-details"],[1,"detail-row"]],template:function(l,d){l&1&&(t(0,"div",0)(1,"div",1)(2,"h2"),i(3,"Importa\xE7\xE3o de Notas Fiscais"),e(),t(4,"p"),i(5,"Monitoramento e importa\xE7\xE3o autom\xE1tica via Receita Federal"),e()(),t(6,"div",2)(7,"p-card"),u(8,G,4,0,"ng-template",3),t(9,"p-table",4),u(10,X,11,0,"ng-template",3)(11,Y,13,5,"ng-template",5),e()()(),t(12,"div",6)(13,"p-card"),u(14,Z,2,0,"ng-template",3),t(15,"p-table",7),u(16,tt,16,0,"ng-template",3)(17,et,18,10,"ng-template",5)(18,ot,37,6,"ng-template",8),e()()()(),t(19,"p-dialog",9),I("visibleChange",function(b){return N(d.showNotaDialog,b)||(d.showNotaDialog=b),b}),u(20,rt,30,7,"div",10),e()),l&2&&(o(9),p("value",d.cnpjs)("responsive",!0),o(6),p("value",d.notasFiscais)("responsive",!0)("dataKey","id"),o(4),C(h(11,q)),P("visible",d.showNotaDialog),p("modal",!0)("closable",!0),o(),p("ngIf",d.selectedNota))},dependencies:[k,O,T,j,V,z,U,A,H,R,B,J,L,K,W,F,D],styles:[".importacao-notas[_ngcontent-%COMP%]{padding:2rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#2c3e50;font-size:2rem;font-weight:600}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:1.1rem}.cnpjs-section[_ngcontent-%COMP%], .notas-section[_ngcontent-%COMP%]{margin-bottom:2rem}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.nota-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid #e9ecef}.detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d}.expanded-content[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;margin:1rem;overflow:hidden;border:1px solid #e9ecef}.expanded-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center}.expanded-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600;display:flex;align-items:center;gap:.5rem}.expanded-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.item-count[_ngcontent-%COMP%]{background:#fff3;padding:.25rem .75rem;border-radius:12px;font-size:.85rem;font-weight:500}.items-table-container[_ngcontent-%COMP%]{background:#fff;overflow-x:auto}.items-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}.items-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f1f3f4;color:#2c3e50;font-weight:600;padding:.75rem 1rem;text-align:left;border-bottom:2px solid #e9ecef;font-size:.85rem;text-transform:uppercase;letter-spacing:.5px}.items-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #f1f3f4;vertical-align:top}.even-row[_ngcontent-%COMP%]{background:#fafbfc}.odd-row[_ngcontent-%COMP%]{background:#fff}.even-row[_ngcontent-%COMP%]:hover, .odd-row[_ngcontent-%COMP%]:hover{background:#e3f2fd!important}.item-description[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.item-description[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;font-size:.9rem}.tipo-despesa[_ngcontent-%COMP%]{color:#667eea;font-size:.75rem;font-weight:500;background:#667eea1a;padding:.125rem .5rem;border-radius:8px;display:inline-block}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.ncm-code[_ngcontent-%COMP%]{background:#f8f9fa;color:#495057;padding:.25rem .5rem;border-radius:4px;font-family:Courier New,monospace;font-size:.8rem;border:1px solid #e9ecef}.expanded-footer[_ngcontent-%COMP%]{background:#fff;padding:1rem 1.5rem;border-top:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center}.total-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.total-label[_ngcontent-%COMP%]{color:#6c757d;font-weight:500}.total-value[_ngcontent-%COMP%]{color:#2c3e50;font-weight:700;font-size:1.1rem}.actions-info[_ngcontent-%COMP%]{display:flex;gap:.5rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button.p-button-text{color:#667eea!important;padding:.25rem!important;min-width:auto!important;width:2rem!important;height:2rem!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button.p-button-text:hover{background:#667eea1a!important;color:#5a67d8!important}@media (max-width: 768px){.card-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.action-buttons[_ngcontent-%COMP%]{justify-content:center}.expanded-header[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem;text-align:center}.expanded-footer[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.items-table-container[_ngcontent-%COMP%]{overflow-x:auto}.items-table[_ngcontent-%COMP%]{min-width:600px}}"]});let r=m;return r})();export{Mt as ImportacaoNotasComponent};
